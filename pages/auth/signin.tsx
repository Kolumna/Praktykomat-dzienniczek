import { signIn } from "next-auth/react";
import { FormEventHandler, useEffect, useState } from "react";
import "../../app/globals.css";

export default function Signin() {
  const [userInfo, setUserInfo] = useState({ email: "", password: "" });
  const [error, setError] = useState(false);

  const handleSubmit: FormEventHandler<HTMLFormElement> = async (e) => {
    e.preventDefault();

    try {
      await signIn("credentials", {
        email: userInfo.email,
        password: userInfo.password,
        callbackUrl: "/panel",
      });
    } catch (error) {
      console.log(error);
    }
  };

  useEffect(() => {
    const searchParams = new URLSearchParams(window.location.search);
    document.querySelector("html")?.setAttribute("data-theme", "light");
    if (searchParams.get("error") === "CredentialsSignin") {
      setError(true);
    }
  }, []);

  return (
    <section className="flex flex-col gap-24 justify-center items-center h-screen">
      <div>
        <svg
          className="w-full xl:w-auto px-12"
          width="550"
          viewBox="0 0 713 76"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M98.8182 74H74.0682V4.18182H99.0227C106.045 4.18182 112.091 5.57954 117.159 8.375C122.227 11.1477 126.125 15.1364 128.852 20.3409C131.602 25.5455 132.977 31.7727 132.977 39.0227C132.977 46.2955 131.602 52.5455 128.852 57.7727C126.125 63 122.205 67.0114 117.091 69.8068C112 72.6023 105.909 74 98.8182 74ZM88.8295 61.3523H98.2045C102.568 61.3523 106.239 60.5795 109.216 59.0341C112.216 57.4659 114.466 55.0455 115.966 51.7727C117.489 48.4773 118.25 44.2273 118.25 39.0227C118.25 33.8636 117.489 29.6477 115.966 26.375C114.466 23.1023 112.227 20.6932 109.25 19.1477C106.273 17.6023 102.602 16.8295 98.2386 16.8295H88.8295V61.3523ZM143.366 74V65.3409L169.003 33.6023V33.2273H144.253V21.6364H186.491V31.0795L162.423 62.0341V62.4091H187.378V74H143.366ZM198.483 74V21.6364H213.006V74H198.483ZM205.778 14.8864C203.619 14.8864 201.767 14.1705 200.222 12.7386C198.699 11.2841 197.938 9.54545 197.938 7.52272C197.938 5.52272 198.699 3.80682 200.222 2.375C201.767 0.920452 203.619 0.193178 205.778 0.193178C207.938 0.193178 209.778 0.920452 211.301 2.375C212.847 3.80682 213.619 5.52272 213.619 7.52272C213.619 9.54545 212.847 11.2841 211.301 12.7386C209.778 14.1705 207.938 14.8864 205.778 14.8864ZM248.503 75.0227C243.116 75.0227 238.48 73.9318 234.594 71.75C230.73 69.5455 227.753 66.4318 225.662 62.4091C223.571 58.3636 222.526 53.5795 222.526 48.0568C222.526 42.6705 223.571 37.9432 225.662 33.875C227.753 29.8068 230.696 26.6364 234.491 24.3636C238.31 22.0909 242.787 20.9545 247.923 20.9545C251.378 20.9545 254.594 21.5114 257.571 22.625C260.571 23.7159 263.185 25.3636 265.412 27.5682C267.662 29.7727 269.412 32.5455 270.662 35.8864C271.912 39.2045 272.537 43.0909 272.537 47.5455V51.5341H228.321V42.5341H258.866C258.866 40.4432 258.412 38.5909 257.503 36.9773C256.594 35.3636 255.332 34.1023 253.719 33.1932C252.128 32.2614 250.276 31.7955 248.162 31.7955C245.957 31.7955 244.003 32.3068 242.298 33.3295C240.616 34.3295 239.298 35.6818 238.344 37.3864C237.389 39.0682 236.901 40.9432 236.878 43.0114V51.5682C236.878 54.1591 237.355 56.3977 238.31 58.2841C239.287 60.1705 240.662 61.625 242.435 62.6477C244.207 63.6705 246.31 64.1818 248.741 64.1818C250.355 64.1818 251.832 63.9545 253.173 63.5C254.514 63.0455 255.662 62.3636 256.616 61.4545C257.571 60.5455 258.298 59.4318 258.798 58.1136L272.23 59C271.548 62.2273 270.151 65.0455 268.037 67.4545C265.946 69.8409 263.241 71.7045 259.923 73.0455C256.628 74.3636 252.821 75.0227 248.503 75.0227ZM296.537 43.7273V74H282.014V21.6364H295.855V30.875H296.469C297.628 27.8295 299.571 25.4205 302.298 23.6477C305.026 21.8523 308.332 20.9545 312.219 20.9545C315.855 20.9545 319.026 21.75 321.73 23.3409C324.435 24.9318 326.537 27.2045 328.037 30.1591C329.537 33.0909 330.287 36.5909 330.287 40.6591V74H315.764V43.25C315.787 40.0455 314.969 37.5455 313.31 35.75C311.651 33.9318 309.366 33.0227 306.457 33.0227C304.503 33.0227 302.776 33.4432 301.276 34.2841C299.798 35.125 298.639 36.3523 297.798 37.9659C296.98 39.5568 296.56 41.4773 296.537 43.7273ZM356.256 43.7273V74H341.733V21.6364H355.574V30.875H356.188C357.347 27.8295 359.29 25.4205 362.017 23.6477C364.744 21.8523 368.051 20.9545 371.938 20.9545C375.574 20.9545 378.744 21.75 381.449 23.3409C384.153 24.9318 386.256 27.2045 387.756 30.1591C389.256 33.0909 390.006 36.5909 390.006 40.6591V74H375.483V43.25C375.506 40.0455 374.688 37.5455 373.028 35.75C371.369 33.9318 369.085 33.0227 366.176 33.0227C364.222 33.0227 362.494 33.4432 360.994 34.2841C359.517 35.125 358.358 36.3523 357.517 37.9659C356.699 39.5568 356.278 41.4773 356.256 43.7273ZM401.452 74V21.6364H415.974V74H401.452ZM408.747 14.8864C406.588 14.8864 404.736 14.1705 403.19 12.7386C401.668 11.2841 400.906 9.54545 400.906 7.52272C400.906 5.52272 401.668 3.80682 403.19 2.375C404.736 0.920452 406.588 0.193178 408.747 0.193178C410.906 0.193178 412.747 0.920452 414.27 2.375C415.815 3.80682 416.588 5.52272 416.588 7.52272C416.588 9.54545 415.815 11.2841 414.27 12.7386C412.747 14.1705 410.906 14.8864 408.747 14.8864ZM440.767 58.9318L440.801 41.5114H442.915L459.688 21.6364H476.358L453.824 47.9545H450.381L440.767 58.9318ZM427.608 74V4.18182H442.131V74H427.608ZM460.335 74L444.926 51.1932L454.608 40.9318L477.347 74H460.335ZM504.986 75.0227C499.69 75.0227 495.111 73.8977 491.247 71.6477C487.406 69.375 484.44 66.2159 482.349 62.1705C480.259 58.1023 479.213 53.3864 479.213 48.0227C479.213 42.6136 480.259 37.8864 482.349 33.8409C484.44 29.7727 487.406 26.6136 491.247 24.3636C495.111 22.0909 499.69 20.9545 504.986 20.9545C510.281 20.9545 514.849 22.0909 518.69 24.3636C522.554 26.6136 525.531 29.7727 527.622 33.8409C529.713 37.8864 530.759 42.6136 530.759 48.0227C530.759 53.3864 529.713 58.1023 527.622 62.1705C525.531 66.2159 522.554 69.375 518.69 71.6477C514.849 73.8977 510.281 75.0227 504.986 75.0227ZM505.054 63.7727C507.463 63.7727 509.474 63.0909 511.088 61.7273C512.702 60.3409 513.918 58.4545 514.736 56.0682C515.577 53.6818 515.997 50.9659 515.997 47.9205C515.997 44.875 515.577 42.1591 514.736 39.7727C513.918 37.3864 512.702 35.5 511.088 34.1136C509.474 32.7273 507.463 32.0341 505.054 32.0341C502.622 32.0341 500.577 32.7273 498.918 34.1136C497.281 35.5 496.043 37.3864 495.202 39.7727C494.384 42.1591 493.974 44.875 493.974 47.9205C493.974 50.9659 494.384 53.6818 495.202 56.0682C496.043 58.4545 497.281 60.3409 498.918 61.7273C500.577 63.0909 502.622 63.7727 505.054 63.7727ZM540.202 74V21.6364H554.043V30.875H554.656C555.747 27.8068 557.565 25.3864 560.111 23.6136C562.656 21.8409 565.702 20.9545 569.247 20.9545C572.838 20.9545 575.895 21.8523 578.418 23.6477C580.94 25.4205 582.622 27.8295 583.463 30.875H584.009C585.077 27.875 587.009 25.4773 589.804 23.6818C592.622 21.8636 595.952 20.9545 599.793 20.9545C604.679 20.9545 608.645 22.5114 611.69 25.625C614.759 28.7159 616.293 33.1023 616.293 38.7841V74H601.804V41.6477C601.804 38.7386 601.031 36.5568 599.486 35.1023C597.94 33.6477 596.009 32.9205 593.69 32.9205C591.054 32.9205 588.997 33.7614 587.52 35.4432C586.043 37.1023 585.304 39.2955 585.304 42.0227V74H571.224V41.3409C571.224 38.7727 570.486 36.7273 569.009 35.2045C567.554 33.6818 565.634 32.9205 563.247 32.9205C561.634 32.9205 560.179 33.3295 558.884 34.1477C557.611 34.9432 556.599 36.0682 555.849 37.5227C555.099 38.9545 554.724 40.6364 554.724 42.5682V74H540.202ZM642.696 74.9886C639.355 74.9886 636.378 74.4091 633.764 73.25C631.151 72.0682 629.082 70.3295 627.56 68.0341C626.06 65.7159 625.31 62.8295 625.31 59.375C625.31 56.4659 625.844 54.0227 626.912 52.0455C627.98 50.0682 629.435 48.4773 631.276 47.2727C633.116 46.0682 635.207 45.1591 637.548 44.5455C639.912 43.9318 642.389 43.5 644.98 43.25C648.026 42.9318 650.48 42.6364 652.344 42.3636C654.207 42.0682 655.56 41.6364 656.401 41.0682C657.241 40.5 657.662 39.6591 657.662 38.5455V38.3409C657.662 36.1818 656.98 34.5114 655.616 33.3295C654.276 32.1477 652.366 31.5568 649.889 31.5568C647.276 31.5568 645.196 32.1364 643.651 33.2955C642.105 34.4318 641.082 35.8636 640.582 37.5909L627.151 36.5C627.832 33.3182 629.173 30.5682 631.173 28.25C633.173 25.9091 635.753 24.1136 638.912 22.8636C642.094 21.5909 645.776 20.9545 649.957 20.9545C652.866 20.9545 655.651 21.2955 658.31 21.9773C660.991 22.6591 663.366 23.7159 665.435 25.1477C667.526 26.5795 669.173 28.4205 670.378 30.6705C671.582 32.8977 672.185 35.5682 672.185 38.6818V74H658.412V66.7386H658.003C657.162 68.375 656.037 69.8182 654.628 71.0682C653.219 72.2955 651.526 73.2614 649.548 73.9659C647.571 74.6477 645.287 74.9886 642.696 74.9886ZM646.855 64.9659C648.991 64.9659 650.878 64.5455 652.514 63.7045C654.151 62.8409 655.435 61.6818 656.366 60.2273C657.298 58.7727 657.764 57.125 657.764 55.2841V49.7273C657.31 50.0227 656.685 50.2955 655.889 50.5455C655.116 50.7727 654.241 50.9886 653.264 51.1932C652.287 51.375 651.31 51.5455 650.332 51.7045C649.355 51.8409 648.469 51.9659 647.673 52.0795C645.969 52.3295 644.48 52.7273 643.207 53.2727C641.935 53.8182 640.946 54.5568 640.241 55.4886C639.537 56.3977 639.185 57.5341 639.185 58.8977C639.185 60.875 639.901 62.3864 641.332 63.4318C642.787 64.4545 644.628 64.9659 646.855 64.9659ZM711.304 21.6364V32.5455H679.77V21.6364H711.304ZM686.929 9.09091H701.452V57.9091C701.452 59.25 701.656 60.2955 702.065 61.0455C702.474 61.7727 703.043 62.2841 703.77 62.5795C704.52 62.875 705.384 63.0227 706.361 63.0227C707.043 63.0227 707.724 62.9659 708.406 62.8523C709.088 62.7159 709.611 62.6136 709.974 62.5455L712.259 73.3523C711.531 73.5795 710.509 73.8409 709.19 74.1364C707.872 74.4545 706.27 74.6477 704.384 74.7159C700.884 74.8523 697.815 74.3864 695.179 73.3182C692.565 72.25 690.531 70.5909 689.077 68.3409C687.622 66.0909 686.906 63.25 686.929 59.8182V9.09091Z"
            fill="#64748B"
          />
          <rect y="3" width="58" height="71" rx="10" fill="#64748B" />
          <rect x="11" y="51" width="35" height="11" rx="5" fill="white" />
        </svg>
      </div>
      <div className="card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100">
        <form className="card-body" onSubmit={handleSubmit}>
          {error && (
            <div className="alert alert-error">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                strokeWidth={1.5}
                stroke="currentColor"
                className="w-6 h-6"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  d="M12 9v3.75m0-10.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.249-8.25-3.286zm0 13.036h.008v.008H12v-.008z"
                />
              </svg>
              Błedne dane!
            </div>
          )}
          <div className="form-control">
            <label className="label">
              <span className="label-text">Email</span>
            </label>
            <input
              type="text"
              placeholder="email"
              className={`input input-bordered`}
              value={userInfo.email}
              onChange={(e) =>
                setUserInfo({ ...userInfo, email: e.target.value })
              }
            />
          </div>
          <div className="form-control">
            <label className="label">
              <span className="label-text">Hasło</span>
            </label>
            <input
              type="password"
              placeholder="hasło"
              className={`input input-bordered`}
              value={userInfo.password}
              onChange={(e) =>
                setUserInfo({ ...userInfo, password: e.target.value })
              }
            />
            <label className="label">
              {/* <a href="#" className="label-text-alt link link-hover">
                Zapomniałeś hasła?
              </a> */}
            </label>
          </div>
          <div className="form-control mt-6">
            <button type="submit" className="btn btn-primary">
              Zaloguj
            </button>
          </div>
        </form>
      </div>
    </section>
  );
}
